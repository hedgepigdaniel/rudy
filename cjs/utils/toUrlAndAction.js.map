{"version":3,"sources":["../../src/utils/toUrlAndAction.js"],"names":["to","routes","basename","currentPathname","options","basenames","url","action","Array","isArray","charAt","shift","join","e","process","env","NODE_ENV","console","warn","bn","isExternal","indexOf","api","fullUrl"],"mappings":";;;;;;;AACA;;AACA;;;;;;;;;;;;eAUe,kBACbA,EADa,EAEbC,MAFa,EAMF;AAAA,MAHXC,QAGW,uEAHS,EAGT;AAAA,MAFXC,eAEW;AAAA,MADXC,OACW;AAAA,MACHC,SADG,GACWD,OADX,CACHC,SADG;AAEX,MAAIC,GAAG,GAAG,EAAV;AACA,MAAIC,MAAJ;;AAEA,MAAI,CAACP,EAAL,EAAS;AACPM,IAAAA,GAAG,GAAG,GAAN;AACD;;AACD,MAAIN,EAAE,IAAI,OAAOA,EAAP,KAAc,QAAxB,EAAkC;AAChCM,IAAAA,GAAG,GAAGN,EAAN;AACD,GAFD,MAEO,IAAIQ,KAAK,CAACC,OAAN,CAAcT,EAAd,CAAJ,EAAuB;AAC5B,QAAIA,EAAE,CAAC,CAAD,CAAF,CAAMU,MAAN,CAAa,CAAb,MAAoB,GAAxB,EAA6B;AAC3BR,MAAAA,QAAQ,GAAGF,EAAE,CAACW,KAAH,EAAX;AACD;;AAEDL,IAAAA,GAAG,cAAON,EAAE,CAACY,IAAH,CAAQ,GAAR,CAAP,CAAH;AACD,GANM,MAMA,IAAI,QAAOZ,EAAP,MAAc,QAAlB,EAA4B;AACjCO,IAAAA,MAAM,GAAGP,EAAT;;AAEA,QAAI;AACF;;AADE,yBACU,uBAAYO,MAAZ,EAAoB;AAAEN,QAAAA,MAAM,EAANA,MAAF;AAAUG,QAAAA,OAAO,EAAPA;AAAV,OAApB,CADV;;AACEE,MAAAA,GADF,gBACEA,GADF;AAEFJ,MAAAA,QAAQ,GAAGK,MAAM,CAACL,QAAP,IAAmBA,QAAnB,IAA+B,EAA1C;AACD,KAHD,CAGE,OAAOW,CAAP,EAAU;AACV,UAAIC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,aAA7B,EAA4C;AAC1C;AACAC,QAAAA,OAAO,CAACC,IAAR,CAAa,gDAAb,EAA+DX,MAA/D;AACD;;AAEDD,MAAAA,GAAG,GAAG,GAAN;AACD;AACF;;AAED,MAAMa,EAAE,GAAGd,SAAS,IAAI,wBAAaC,GAAb,EAAkBD,SAAlB,CAAxB;;AAEA,MAAIc,EAAJ,EAAQ;AACNjB,IAAAA,QAAQ,GAAGiB,EAAX;AACAb,IAAAA,GAAG,GAAG,yBAAcA,GAAd,EAAmBa,EAAnB,CAAN;AACD;;AAED,MAAIb,GAAG,CAACI,MAAJ,CAAW,CAAX,MAAkB,GAAtB,EAA2B;AACzBJ,IAAAA,GAAG,aAAMH,eAAN,SAAwBG,GAAxB,CAAH;AACD,GAFD,MAEO,IAAIA,GAAG,CAACI,MAAJ,CAAW,CAAX,MAAkB,GAAtB,EAA2B;AAChCJ,IAAAA,GAAG,GAAG,8BAAgBA,GAAhB,EAAqBH,eAArB,CAAN;AACD;;AAED,MAAMiB,UAAU,GAAGd,GAAG,CAACe,OAAJ,CAAY,MAAZ,MAAwB,CAA3C;;AAEA,MAAI,CAACd,MAAD,IAAW,CAACa,UAAhB,EAA4B;AAC1B,QAAME,GAAG,GAAG;AAAErB,MAAAA,MAAM,EAANA,MAAF;AAAUG,MAAAA,OAAO,EAAPA;AAAV,KAAZ;AACAG,IAAAA,MAAM,GAAG,oBAASe,GAAT,EAAchB,GAAd,CAAT;AACD;;AAED,MAAIJ,QAAJ,EAAc;AACZK,IAAAA,MAAM,qBAAQA,MAAR;AAAgBL,MAAAA,QAAQ,EAARA;AAAhB,MAAN;AACD;;AAED,MAAMqB,OAAO,GAAGH,UAAU,GAAGd,GAAH,GAASJ,QAAQ,GAAGI,GAA9C;AACA,SAAO;AAAEiB,IAAAA,OAAO,EAAPA,OAAF;AAAWhB,IAAAA,MAAM,EAANA;AAAX,GAAP;AACD,C","sourcesContent":["// @flow\nimport resolvePathname from 'resolve-pathname'\nimport {\n  actionToUrl,\n  toAction,\n  findBasename,\n  stripBasename,\n} from '@respond-framework/rudy'\nimport type { Routes, Options } from '@respond-framework/rudy'\n\nexport type To = string | Array<string> | Object\n\nexport default (\n  to?: ?To,\n  routes: Routes,\n  basename: ?string = '',\n  currentPathname: string,\n  options: Options,\n): Object => {\n  const { basenames } = options\n  let url = ''\n  let action\n\n  if (!to) {\n    url = '#'\n  }\n  if (to && typeof to === 'string') {\n    url = to\n  } else if (Array.isArray(to)) {\n    if (to[0].charAt(0) === '/') {\n      basename = to.shift()\n    }\n\n    url = `/${to.join('/')}`\n  } else if (typeof to === 'object') {\n    action = to\n\n    try {\n      ;({ url } = actionToUrl(action, { routes, options }))\n      basename = action.basename || basename || ''\n    } catch (e) {\n      if (process.env.NODE_ENV === 'development') {\n        // eslint-disable-next-line no-console\n        console.warn('[rudy/Link] could not create path from action:', action)\n      }\n\n      url = '#'\n    }\n  }\n\n  const bn = basenames && findBasename(url, basenames)\n\n  if (bn) {\n    basename = bn\n    url = stripBasename(url, bn)\n  }\n\n  if (url.charAt(0) === '#') {\n    url = `${currentPathname}${url}`\n  } else if (url.charAt(0) !== '/') {\n    url = resolvePathname(url, currentPathname)\n  }\n\n  const isExternal = url.indexOf('http') === 0\n\n  if (!action && !isExternal) {\n    const api = { routes, options }\n    action = toAction(api, url)\n  }\n\n  if (basename) {\n    action = { ...action, basename }\n  }\n\n  const fullUrl = isExternal ? url : basename + url\n  return { fullUrl, action }\n}\n"],"file":"toUrlAndAction.js"}