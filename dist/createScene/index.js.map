{"version":3,"sources":["../../src/createScene/index.js"],"names":["routesMap","opts","sc","scene","bn","basename","formatter","formatRoute","subtypes","st","log","logExports","prefix","keys","Object","result","reduce","t","types","actions","routes","t2","tc","te","route","tClean","replace","action","Array","isArray","key","forEach","name","suffix","toUpperCase","cleanType","realType","test","process","env","NODE_ENV","exportString"],"mappings":"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","sourcesContent":["// @flow\nimport type { RoutesMapInput, CreateActionsOptions } from '../flow-types'\n\nimport { camelCase, logExports, makeActionCreator, formatRoute } from './utils'\n\nexport default (routesMap: RoutesMapInput, opts: CreateActionsOptions = {}) => {\n  const {\n    scene: sc,\n    basename: bn,\n    formatRoute: formatter,\n    subtypes: st = [],\n    logExports: log,\n  } = opts\n\n  const scene = sc || ''\n  const prefix = scene ? `${scene}/` : ''\n  const keys = Object.keys(routesMap)\n  const subtypes = [...st, 'start', 'complete', 'error', 'done']\n\n  const result = keys.reduce(\n    (result, t) => {\n      const { types, actions, routes } = result\n\n      const t2 = `${prefix}${t}`\n      const tc = `${prefix}${t}_COMPLETE`\n      const te = `${prefix}${t}_ERROR`\n\n      routes[t2] = formatRoute(routesMap[t], t2, routesMap, formatter)\n\n      const route = routes[t2]\n      const tClean = route.scene ? t2.replace(`${route.scene}/`, '') : t // strip the scene so types will be un-prefixed (NOTE: this is normalization for if routes pass through `createScene` twice)\n      const action = camelCase(tClean)\n\n      types[tClean] = t2\n      types[`${tClean}_COMPLETE`] = tc\n      types[`${tClean}_ERROR`] = te\n\n      // allow for creating custom action creators (whose names are an array assigned to route.action)\n      if (Array.isArray(route.action)) {\n        const key = route.action[0]\n        actions[action] = makeActionCreator(route, t2, key, bn) // the first action in the array becomes the primary action creator\n\n        // all are tacked on like action.complete, action.error\n        route.action.forEach((key: string) => {\n          actions[action][key] = makeActionCreator(route, t2, key, bn)\n        })\n      } else {\n        actions[action] = makeActionCreator(route, t2, 'action', bn)\n      }\n\n      subtypes.forEach((name) => {\n        const suffix = `_${name.toUpperCase()}`\n        const cleanType = `${tClean}${suffix}`\n        const realType = `${prefix}${t}${suffix}`\n\n        types[cleanType] = realType\n        actions[action][name] = makeActionCreator(\n          route,\n          realType,\n          name,\n          bn,\n          subtypes,\n        )\n      })\n\n      return result\n    },\n    { types: {}, actions: {}, routes: {} },\n  )\n\n  const { types, actions } = result\n  // $FlowFixMe\n  if (log && /^(development|test)$/.test(process.env.NODE_ENV)) {\n    result.exportString = logExports(types, actions, result.routes, opts)\n  }\n\n  return result\n}\n"],"file":"index.js"}