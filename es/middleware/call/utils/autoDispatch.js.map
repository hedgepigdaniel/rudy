{"version":3,"sources":["../../../../src/middleware/call/utils/autoDispatch.js"],"names":["req","callback","route","name","isOptCb","Promise","resolve","then","res","tryDispatch","hasReturn","_dispatched","isAutoDispatch","options","dispatch","autoDispatch","undefined"],"mappings":"AAAA,gBAAe,UAACA,GAAD,EAAMC,QAAN,EAAgBC,KAAhB,EAAuBC,IAAvB,EAA6BC,OAA7B;AAAA,SACbC,OAAO,CAACC,OAAR,CAAgBL,QAAQ,CAACD,GAAD,CAAxB,EAA+BO,IAA/B,CAAoC,UAACC,GAAD;AAAA,WAClCC,WAAW,CAACT,GAAD,EAAMQ,GAAN,EAAWN,KAAX,EAAkBC,IAAlB,EAAwBC,OAAxB,CADuB;AAAA,GAApC,CADa;AAAA,CAAf;;AAKA,IAAMK,WAAW,GAAG,SAAdA,WAAc,CAACT,GAAD,EAAMQ,GAAN,EAAWN,KAAX,EAAkBC,IAAlB,EAAwBC,OAAxB,EAAoC;AACtD,MAAII,GAAG,KAAK,KAAZ,EAAmB,OAAO,KAAP;AACnB,MAAME,SAAS,GAAGF,GAAG,KAAK,IAAR,IAAiBA,GAAG,IAAI,CAACA,GAAG,CAACG,WAA/C,CAFsD,CAEM;;AAE5D,MAAID,SAAS,IAAIE,cAAc,CAACV,KAAD,EAAQF,GAAG,CAACa,OAAZ,EAAqBT,OAArB,CAA/B,EAA8D;AAC5D;AACA,WAAOC,OAAO,CAACC,OAAR,CAAgBN,GAAG,CAACc,QAAJ,CAAaN,GAAb,CAAhB,CAAP;AACD;;AAED,SAAOA,GAAP;AACD,CAVD;;AAYA,IAAMI,cAAc,GAAG,SAAjBA,cAAiB,CAACV,KAAD,EAAQW,OAAR,EAAiBT,OAAjB;AAAA,SACrBA,OAAO,GACHS,OAAO,CAACE,YAAR,KAAyBC,SAAzB,GACE,IADF,GAEEH,OAAO,CAACE,YAHP,GAIHb,KAAK,CAACa,YAAN,KAAuBC,SAAvB,GACAd,KAAK,CAACa,YADN,GAEAF,OAAO,CAACE,YAAR,KAAyBC,SAAzB,GACA,IADA,GAEAH,OAAO,CAACE,YATS;AAAA,CAAvB","sourcesContent":["export default (req, callback, route, name, isOptCb) =>\n  Promise.resolve(callback(req)).then((res) =>\n    tryDispatch(req, res, route, name, isOptCb),\n  )\n\nconst tryDispatch = (req, res, route, name, isOptCb) => {\n  if (res === false) return false\n  const hasReturn = res === null || (res && !res._dispatched) // `res._dispatched` indicates it was manually dispatched\n\n  if (hasReturn && isAutoDispatch(route, req.options, isOptCb)) {\n    // if no dispatch was detected, and a result was returned, dispatch it automatically\n    return Promise.resolve(req.dispatch(res))\n  }\n\n  return res\n}\n\nconst isAutoDispatch = (route, options, isOptCb) =>\n  isOptCb\n    ? options.autoDispatch === undefined\n      ? true\n      : options.autoDispatch\n    : route.autoDispatch !== undefined\n    ? route.autoDispatch\n    : options.autoDispatch === undefined\n    ? true\n    : options.autoDispatch\n"],"file":"autoDispatch.js"}